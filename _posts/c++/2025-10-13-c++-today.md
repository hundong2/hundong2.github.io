---
title: "C++ - P2361R6: Defer Statement"
date: 2025-10-13 21:03:24 +0900
categories: c++
tags: [c++, 최신기술, 추천, C++, P2361R6:, Defer, Statement]
---

## 오늘의 C++ 최신 기술 트렌드: **P2361R6: Defer Statement**

**1. 간단한 설명:**

`defer` 문은 Go 언어에서 널리 사용되는 기능으로, C++에 도입하려는 제안입니다. `defer` 문은 현재 스코프가 종료될 때 (함수 종료, 블록 종료 등) 특정 코드를 실행하도록 예약합니다. 이는 리소스 정리, 로그 출력, 예외 처리 등 다양한 상황에서 유용하며, RAII (Resource Acquisition Is Initialization)와 유사하지만, RAII가 객체 소멸자에 의존하는 반면 `defer`는 명시적으로 코드를 지정할 수 있다는 장점이 있습니다. 특히 예외 안전 코드를 작성할 때 가독성을 높이고 오류 가능성을 줄이는 데 도움이 됩니다. P2361R6은 이 기능을 C++에 도입하기 위한 최신 제안서입니다. 제안서는 `defer` 문법과 동작 방식을 정의하고, 사용 사례를 설명하며, 구현상의 고려 사항을 논의합니다.

**2. 참고할 만한 공식 사이트나 블로그 링크:**

*   **P2361R6**: [http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2361r6.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2361r6.pdf)
*   **Reddit 토론**: [https://www.reddit.com/r/cpp/comments/x84z6d/p2361r6_defer_statement/](https://www.reddit.com/r/cpp/comments/x84z6d/p2361r6_defer_statement/)
*   **비슷한 기능의 구현체 (Quick Defer)**: [https://github.com/Neargye/quick_defer](https://github.com/Neargye/quick_defer)

**3. 간단한 코드 예시 (C++):**

```cpp
#include <iostream>
#include <fstream>

// Defer 매크로를 직접 정의하여 사용할 수 있습니다.
// (실제 defer 문은 C++ 표준에 포함되지 않았으므로, 비슷한 동작을 흉내내는 것입니다.)
#define DEFER_1(x, n) auto DEFER_VAR_ ## n = detail::defer_call{[&](){x;}};
#define DEFER(x) DEFER_1(x, __COUNTER__)

namespace detail {
    struct defer_call {
        std::function<void()> fn;
        ~defer_call() {
            fn();
        }
    };
}

int main() {
    std::ofstream file("example.txt");
    if (!file.is_open()) {
        std::cerr << "파일을 열 수 없습니다." << std::endl;
        return 1;
    }

    DEFER(file.close()); // 스코프가 종료될 때 file.close()를 호출합니다.

    file << "Hello, world!" << std::endl;
    std::cout << "파일에 내용을 썼습니다." << std::endl;

    return 0;
}
```

**4. 코드 실행 결과 예시:**

```
파일에 내용을 썼습니다.
```

`example.txt` 파일에 "Hello, world!"라는 내용이 쓰여집니다. `defer` 문 덕분에 파일이 항상 제대로 닫히게 됩니다. (예외가 발생하더라도)

